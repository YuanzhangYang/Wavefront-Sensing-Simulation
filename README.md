# Wavefront Sensing Simulation Using a Lateral Shearing Interferometer for Zernike Aberrations

**High-fidelity MATLAB toolbox for simulating and visualizing interference patterns in lateral shearing interferometry under various Zernike aberrations — might be useful for optical metrology, adaptive optics, wavefront sensing, and silicon photonics research.**

[![MATLAB](https://img.shields.io/badge/MATLAB-R2020b+-blue)](https://www.mathworks.com/products/matlab.html)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Open Source](https://badges.frapsoft.com/os/v1/open-source.svg?v=103)](https://github.com/ellerbrock/open-source-badges/)

## Abstract

This study presents a computational simulation of wavefront sensing using a lateral shearing interferometer, following the principles outlined by Murty (1964), to analyze the interference patterns generated by various Zernike aberrations. The simulation models optical wavefronts through a 20 mm circular aperture, subjected to aberrations including defocus, coma, spherical aberration, and astigmatism, under both flat and wedged plate configurations. Interference patterns are computed using a 632.8 nm He-Ne laser, and a dynamic visualization illustrates defocus evolution. The results demonstrate characteristic fringe patterns for each aberration, validating the simulation’s ability to characterize wavefront distortions. This work provides insights into optical metrology and supports applications in adaptive optics and lens design.

## Project Overview

This repository contains a complete MATLAB implementation of a lateral shearing interferometer simulation for low-order Zernike aberrations. The tool reproduces classic interference patterns observed in wavefront metrology:

- **Flat plate** configuration: pure aberration-induced fringes
- **Wedged plate** configuration: additional linear tilt (phase gradient) superimposed, simulating realistic shear
- **Dynamic animation**: coefficient sweep from -2λ to +2λ over 40 frames per aberration type

Key parameters:
- Wavelength λ = 632.8 nm (He-Ne laser)
- Aperture diameter D = 20 mm
- Grid resolution N = 500 × 500
- Fixed OPD Δ = 1 µm (chosen for optimal fringe visibility after empirical tuning)
- Wedge tilt: linear OPD gradient = 10⁻³ × x (m)

The simulation uses **normalized pupil coordinates** (ρ ≤ 1) and computes the optical path difference (OPD) using Zernike polynomials scaled by a coefficient (in units of λ).

## Key Features

- Accurate implementation of primary Zernike polynomials (defocus, horizontal/vertical coma, spherical, 0°/45° astigmatism)
- Support for ideal plane wave, plane wave with linear wedge, and aberration + wedge cases
- High-resolution 2D intensity maps using `contourf` with Parula colormap
- Publication-quality formatting: mm-scale axes, [0,2] intensity clipping, circular aperture masking
- Dynamic GIF generation showing continuous aberration evolution
- Modular code structure with reusable Zernike generator function

## Theoretical Background

The wavefront aberration is expressed as an optical path difference (OPD) **W** using **Zernike polynomials** over the normalized pupil (ρ ≤ 1, θ ∈ [0, 2π)):

| Aberration Type     | Zernike Polynomial (OPD W)                                      | Coefficient Scaling |
|---------------------|------------------------------------------------------------------|---------------------|
| Defocus             | W = √3 (ρ² − 1)                                                 | coef × W            |
| Horizontal Coma     | W = √8 (3ρ³ − 2ρ) cos θ                                         | coef × W            |
| Vertical Coma       | W = √8 (3ρ³ − 2ρ) sin θ                                         | coef × W            |
| Primary Spherical   | W = √5 (6ρ⁴ − 6ρ² + 1)                                          | coef × W            |
| Astigmatism 0°      | W = √6 ρ² cos(2θ)                                               | coef × W            |
| Astigmatism 45°     | W = √6 ρ² sin(2θ)                                               | coef × W            |

The phase difference is:

Δφ = (2π / λ) × Δ × Z    (for flat plate aberrations)  
Δφ = (2π / λ) × (Δ × Z + linear_coeff × X)    (for wedged plate)

where:
- Δ = 1 × 10⁻⁶ m (fixed OPD)
- linear_coeff = 1 × 10⁻³ m⁻¹ (wedge tilt)
- X is the Cartesian x-coordinate in meters
- Z is the Zernike term above (without the coefficient)

The interference intensity is calculated as:

I(x,y) = 2 × (1 + cos(Δφ)) × mask(ρ ≤ 1)

This two-beam interference model assumes equal amplitude beams and perfect coherence.

## Results & Visualization

The simulation generates:
- Static interferograms for 7 cases (ideal plane, plane + wedge, and 5 aberrations × 2 configurations)
- Dynamic GIF animations for 6 aberration types, sweeping coef from -2 to +2 (40 frames, 0.15 s delay)

Characteristic patterns:
- Defocus → concentric circular/curved fringes
- Coma → comet-like or asymmetric lobes
- Spherical → multiple concentric rings
- Astigmatism → four-fold or two-fold symmetric cloverleaf patterns
- Wedge tilt → superimposed straight parallel fringes

All visualizations use:
- Parula colormap
- Intensity range [0, 2]
- Axes in millimeters
- Circular mask outside ρ > 1

### Animated Demonstrations (Most Representative GIFs)

These GIFs showcase the dynamic evolution of key aberrations as the Zernike coefficient varies from -2 to +2. They clearly illustrate fringe progression, symmetry changes, and amplitude effects — with defocus highlighted as the primary dynamic example from the paper.

![dynamic_defocus](https://github.com/user-attachments/assets/71deac57-cbd5-49e3-81d0-7dcf2b3d33b3)

*Defocus: Smooth transition from concave (negative coef) to convex (positive coef) concentric fringes, with increasing curvature.*

![dynamic_hcoma](https://github.com/user-attachments/assets/4a09eb06-e1b4-4e2a-ac10-0c524cc74355)

*Horizontal Coma: Characteristic comet-like asymmetry evolving from subtle to pronounced lobes.*

![dynamic_spherical](https://github.com/user-attachments/assets/62389960-2874-473c-a1a7-63162cacbe40)

*Spherical Aberration: Multiple concentric rings expanding/contracting with coefficient amplitude.*

![dynamic_astig0](https://github.com/user-attachments/assets/67822e3a-668c-4d19-863d-4afeb6bd994a)
 
*Astigmatism 0°: Four-fold symmetric cloverleaf patterns rotating and intensifying.*

## Community Impact

A tutorial based on this framework was published on a Chinese blog, garnering over **3,000+ reads** and recognition from science and industry practitioners.
